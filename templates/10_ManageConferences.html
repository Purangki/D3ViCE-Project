{% load static %}

  {% block headerinclude %}
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>
      {% block title %}
      {{ page_title|default:"D3ViCE - Conferences" }}
      {% endblock %}
    </title> 
    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <!-- <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous"> -->
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous"> -->

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.1/css/all.css" integrity="sha384-vp86vTRFVJgpjF9jiIGPEEqYqlDwgyBgEF109VFjmqGmIY/Y4HV4d3Gp2irVfcrp" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700%7CRoboto%7CJosefin+Sans:100,300,400,500" rel="stylesheet" type="text/css">
    
    <!-- DataTable -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.22/css/dataTables.bootstrap4.min.css">
    
    <!-- Custom -->
    <link href="{% static 'css/conferenceCRUD.css' %}" rel="stylesheet">
    <!-- <link href="{% static 'css/manage.css' %}" rel="stylesheet"> -->

    <script src="https://code.jquery.com/jquery-1.10.2.js"></script>
  {% endblock headerinclude %}

  {% block footerinclude %}
    <!-- JQuery -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>  -->
    <!-- Popper -->
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <!-- Bootstrap -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
    <!-- Datatables -->
    <script src="https://cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.21/js/dataTables.bootstrap4.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/1.6.2/js/dataTables.buttons.min.js"></script>
    <!-- ClipboardJS -->
    <script src="https://unpkg.com/clipboard@2/dist/clipboard.min.js"></script>
    <!-- Custom -->
    <script src="{% static 'js/conferenceCRUD.js' %}"></script>
  {% endblock footerinclude %} 
	
	<body>
		{% block content %}
		<!-- START OF NAVBAR -->
		<nav class ="navbar-nav navbar-style navbar-fixed-top">
			<div class="container">
				<div class="navbar-header ">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="menuIcon">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
					<a id="tempLogo" class="navbar-logo" href="#">D3ViCE</a>
				</div>
					
				<div class="collapse navbar-collapse" id="menuIcon">	
					<ul class="nav navbar-nav navbar-right">
						<li><a href="../D3ViCE_Conference/dashboard">Dashboard</a></li>
						<li><a href="#">Conference</a></li>
						<li><a href="../D3ViCE_Conference/history">History</a></li>
						<li><a href="../D3ViCE_User/profile">Profile</a></li>
						<li><a href="../D3ViCE_Account/logout">Logout</a></li>
					</ul>					
				</div>
			</div>
		</nav>
		<!-- END OF NAVBAR -->
    <div class="container-fluid">
      <div class = "row">
        <div class = "col-lg-12 px-md-4">
          <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
            <h1 class="h2"><i class="fas fa-clipboard-list"></i> Manage Conferences</h1>
            <div class ="btnConfActions">
              <button type="button" class="btn btn-sm btn-conference">
                <i class="fas fa-sign-in-alt"></i>
                Join Conference
              </button>
              <button type="button" class="btn btn-sm btn-conference" id ="btnCreate" data-toggle="modal" data-target="#createConferenceModal">
                <i class="fas fa-plus-circle"></i>
                Create Conference
              </button>
            </div>
          </div>
          <!-- START OF CARD EDIT AND DELETE MODALS -->
          <div class="row">
            {% for conference in conferences %} 
            <div class="col-sm-4">
              <div class="card mb-3">
                <div class="card-body">
                  <h5 class="card-title pb-2 border-bottom conf-title">{{conference.title}}</h5>
                    <p class="card-text">{{conference.description}}</p>
                    <button type="button" class="btn btn-edit" data-toggle="modal" data-target="#editConferenceModal-{{conference.id}}">
                      <i class="fas fa-edit"></i>
                      Edit Details
                    </button>
                    <button type="button" class="btn btn-delete float-right" data-toggle="modal" data-target="#deleteConferenceModal-{{conference.id}}">
                      <i class="fas fa-trash-alt"></i>
                      Delete
                    </button>
                </div>
              </div>  
            </div>
          <!-- END OF CARD EDIT AND DELETE MODALS -->
          <!-- START OF MODALS -->

          <!-- START MODAL FOR EDIT AND DELETE -->
          <div class= "modal fade" id="editConferenceModal-{{conference.id}}" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog conf-modal" role="document">
          
              <!-- Modal content-->
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                  <h4 class="modal-title"><i class="fas fa-edit"></i>  Edit Details</h4>
                </div>

                <div class="modal-body conf-modal-body">
                  <div class ="row">

                    <div class="col-md-6">
                      <img src="{% static 'img/createConferenceImg.png' %}" class = "img-fluid">
                    </div>

                    <div class="col-md-6 bg-light">
                      <form method="POST">
                        {% csrf_token %}
                        <div class="input-group">
                          <div class="input-group-prepend mt-5 mb-3">
                            <span class="input-group-text conf-prepend">Conference Code</span>
                          </div>
                          <input type="hidden" name="conference_id_num" value={{conference.id}}>
                          <input type= "text" id="code_edit-{{conference.id}}" name="code_edit" class="conf-input form-control mt-5 mb-3" value={{conference.code}} readonly>
                          <div class="input-group-append mt-5 mb-3">
                            <button type="button" id="btn_copy-{{conference.id}}" class="btn conf-prepend copy-to-clipboard" data-clipboard-target="#code_edit-{{conference.id}}" data-toggle="tooltip" title="Copy to clipboard" onclick="updateTooltip('code_edit-{{conference.id}}','btn_copy-{{conference.id}}')"><i class="fas fa-copy"></i></button>
                          </div>
                        </div>

                        <div class="input-group">
                          <div class="input-group-prepend mb-3">
                            <span class="input-group-text conf-prepend">Conference Title</span>
                          </div>
                          <input type="text" id="title_edit-{{conference.id}}" name="title_edit" class="conf-input form-control mb-3" value="{{conference.title}}" required maxlength="150">
                        </div>
                        
                        <div class="input-group">
                          <div class="input-group-prepend mb-3">
                            <span class="input-group-text conf-prepend">Date</span>
                          </div>
                          <input type="date" id="date_edit-{{conference.id}}" name="date_edit" class="conf-input form-control mb-3" value={{conference.date|date:"Y-m-d"}} required>
                          <script type="text/javascript">
                            disableBeforeToday('date_edit-{{conference.id}}');
                          </script>
                        </div>

                        <div class="input-group">
                          <div class="input-group-prepend mb-3">
                            <span class="input-group-text conf-prepend">Time</span>
                          </div>
                          <input type="time" id="time_edit-{{conference.id}}" name="time_edit" class="conf-input form-control mb-3" value={{conference.time|time:"H:i:s"}} required>
                        </div>
                        <textarea class="conf-input mb-3 form-control"  id="desc_edit" name="desc_edit" rows="3" placeholder="Short Description" maxlength="255">{{conference.description}}</textarea>
                        <div class="d-flex justify-content-center mt-2">
                          <button type="submit" id="btn_edit_conference" name="btn_edit_conference" class="btn btn-conference-submit">Save Changes</button>
                        </div>
                      </form>
                   </div>  
                  </div>
                </div><!-- modal body -->
              </div> <!-- modal content -->
            </div> <!-- modal dialog-->
          </div> <!-- end modal -->

          <div class="modal fade" id="deleteConferenceModal-{{conference.id}}" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title"><i class="fas fa-trash-alt"></i> Delete</h5>
                  <button type="button" class="btn close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <form method="POST">
                  {% csrf_token %}
                  <div class="modal-body" style="font-size: 16px;">
                    Are you sure you want to delete {{conference.title}}?
                  </div>
                  <div class="modal-footer">
                    <input type="hidden" name="conference_id_num" value={{conference.id}}>
                    <button type="submit" id="btn_delete_conference" name="btn_delete_conference" class="btn btn-danger">Yes</button>
                    <button type="button" data-dismiss="modal" class="btn btn-primary">No</button>                   
                  </div>
                </form>
              </div>
            </div>
          </div>  
          {% endfor %}

          <!-- END MODAL FOR EDIT AND DELETE -->

          <!-- START MODAL FOR CREATE -->
          <div class="modal fade" id="createConferenceModal" tabindex="-1" role="dialog" aria-hidden="true">
            <div class="modal-dialog conf-modal" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title"><i class="fas fa-plus-circle"></i> Create Conference</h5>
                  <button type="button" class="btn close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="conf-modal-body">
                  <div class="row">
                    <div class="col-md-6">
                      <img src="{% static 'img/createConferenceImg.png' %}" class="img-fluid">
                    </div>
                    <div class="col-md-6 bg-light">
                      <form method="POST">
                        {% csrf_token %}
                        <div class="input-group">
                          <div class="input-group-prepend mt-5 mb-3">
                            <span class="input-group-text conf-prepend">Conference Title</span>
                          </div>
                          <input type="text" id="title_create"name="title_create" class="conf-input form-control mt-5 mb-3" maxlength="150" required>
                        </div>
                        <div class="input-group">
                          <div class="input-group-prepend mb-3">
                            <span class="input-group-text conf-prepend">Date</span>
                          </div>
                          <input type="date" id="date_create" name="date_create" class="conf-input form-control mb-3 input-date-conference" required>
                          <script type="text/javascript">
                            disableBeforeToday('date_create');
                          </script>
                        </div>
                        <div class="input-group">
                          <div class="input-group-prepend mb-3">
                            <span class="input-group-text conf-prepend">Time</span>
                          </div>
                          <input type="time" id="time_create" name="time_create" class="conf-input form-control mb-3" required>
                        </div>
                        <textarea class="conf-input mb-3 form-control" id="desc_create" name="desc_create" rows="3" placeholder="Short Description" maxlength="255"></textarea>
                        <div class="d-flex justify-content-center mt-5">
                          <button type="submit"  id="btn_create_conference" name="btn_create_conference" class="btn btn-conference-submit">Create Conference</button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- END MODAL FOR CREATE-->

          <!-- END OF MODALS -->
        </div>
      </div>
    </div>
		  <script>
			$(document).ready(function() {
			  new ClipboardJS('.copy-to-clipboard');
			} );
		  </script>
	{% endblock content %}
	</body>
</html>